{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "scada",
    "mnemo",
    "dialog",
    "signal",
    "Dialog",
    "construct",
    "__veBlock",
    "__createAndAddVEBlock",
    "__veConfirmWin",
    "__createConfirmWindow",
    "destruct",
    "_disposeObjects",
    "members",
    "_createWidgetContent",
    "_mainWindow",
    "add",
    "_onLoadSettings",
    "settings",
    "dialogSettings",
    "control_ve",
    "__key",
    "extractOptionFromSettings",
    "__veStateKey",
    "_onReceiveData",
    "e",
    "__updateQuestionLabel",
    "getData",
    "win",
    "widget",
    "window",
    "confirm",
    "addListener",
    "_onWindowConfirm",
    "_onWindowDeny",
    "data",
    "hasOwnProperty",
    "undefined",
    "stateLabel",
    "tr",
    "setQuestion",
    "toUpperCase",
    "__createControlVEButton",
    "button",
    "ui",
    "form",
    "Button",
    "_onPressControlVEButton",
    "layout",
    "Flow",
    "setAlignX",
    "block",
    "container",
    "Composite",
    "_confirmActions",
    "push",
    "setOutData",
    "bind",
    "next",
    "hide",
    "_dialogStack",
    "addAfter",
    "show",
    "indexOf",
    "remove",
    "ControlVE"
  ],
  "sources": [
    "C:/Users/dadovaz/Documents/Dialog/mnemo.dialog/source/class/scada/mnemo/dialog/signal/ControlVE.js"
  ],
  "sourcesContent": [
    "qx.Class.define(\"scada.mnemo.dialog.signal.ControlVE\", {\n    extend: scada.mnemo.dialog.signal.Dialog,\n\n    construct() {\n        this.__veBlock = this.__createAndAddVEBlock();\n        super();\n        this.__veConfirmWin = this.__createConfirmWindow();\n    },\n\n    destruct() {\n        this._disposeObjects(\"__veBlock\", \"__veConfirmWin\");\n    },\n\n    members: {\n        _createWidgetContent(){\n            super._createWidgetContent();\n            this._mainWindow.add(this.__veBlock);\n        },\n\n        _onLoadSettings(settings){\n            super._onLoadSettings(settings);\n            const dialogSettings = settings.control_ve;\n            if (!dialogSettings){\n                return;\n            }\n            this.__key = this.extractOptionFromSettings(\"key\", dialogSettings);\n            this.__veStateKey = this.extractOptionFromSettings(\"state_key\", dialogSettings);\n        },\n\n        _onReceiveData(e){\n            super._onReceiveData(e);\n            this.__updateQuestionLabel(e.getData());\n        },\n\n        __createConfirmWindow(){\n            const win = new scada.widget.window.confirm.Dialog();\n            win.addListener(\"confirmed\", this._onWindowConfirm, this);\n            win.addListener(\"denied\", this._onWindowDeny, this);\n            return win;\n        },\n\n        __updateQuestionLabel(data){\n            if (this.__veStateKey && data.hasOwnProperty(this.__veStateKey) && data[this.__veStateKey] !== undefined){\n                let stateLabel;\n                if (data[this.__veStateKey]){\n                    stateLabel = this.tr(\"control state\");\n                }\n                else {\n                    stateLabel = this.tr(\"work state\");\n                }\n                this.__veConfirmWin.setQuestion(stateLabel.toUpperCase());\n            }\n        },\n\n        __createControlVEButton(){\n            const button = new qx.ui.form.Button(\"Управление ВЭ\");\n            button.addListener(\"execute\", this._onPressControlVEButton, this);\n            return button;\n        },\n\n        __createAndAddVEBlock(){\n            const layout = new qx.ui.layout.Flow();\n            layout.setAlignX(\"center\");\n            const block = new qx.ui.container.Composite(layout);\n            block.add(this.__createControlVEButton());\n            return block;\n        },\n\n        _onWindowConfirm(){\n            if (this.__key){\n                this._confirmActions.push(function(){\n                    this.setOutData({[this.__key]: true});\n                }.bind(this));\n                this.next();\n                \n            }\n        },\n\n        _onWindowDeny(){\n            this.hide();\n        },\n\n        _onPressControlVEButton(){\n            this._dialogStack.addAfter(this.__veConfirmWin, this._mainWindow);\n            this.next();\n        },\n\n        show(){\n            super.show();\n            if (this._dialogStack.indexOf(this.__veConfirmWin) !== -1){\n                this._dialogStack.remove(this.__veConfirmWin);\n            }\n        }\n    }\n});"
  ],
  "mappings": "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"
}